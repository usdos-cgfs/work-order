<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
  rel="stylesheet"
  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
  crossorigin="anonymous"
/>

<link
  rel="stylesheet"
  href="../SiteAssets/workorder/vendor/fontawesome-5.9.0/css/all.min.css"
/>

<div id="app">
  <select class="form-control">
    <option>test 1</option>
    <option>test 2</option>
    <option>test 3</option>
    <option>test 4</option>
    <option>test 5</option>
  </select>
  <button data-bind="click: NewRequest">New Request</button>
  <button data-bind="click: ViewRequest">View Request</button>
  <ul class="nav nav-tabs" id="section-tabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="my-requests-tab"
        data-bs-toggle="tab"
        data-bs-target="#my-requests"
        data-bind="click: TabClicked"
        type="button"
        role="tab"
        aria-controls="my-requests"
        aria-selected="true"
      >
        My Orders
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="new-request-tab"
        data-bs-toggle="tab"
        data-bs-target="#new-request"
        data-bind="click: TabClicked"
        type="button"
        role="tab"
        aria-controls="new-request"
        aria-selected="true"
      >
        New Order
      </button>
    </li>
    <li class="nav-item active" role="presentation">
      <button
        class="nav-link"
        id="request-detail-tab"
        data-bs-toggle="tab"
        data-bs-target="#request-detail"
        data-bind="click: TabClicked"
        type="button"
        role="tab"
        aria-controls="request-detail"
        aria-selected="false"
      >
        Detail View
      </button>
    </li>
  </ul>
  <div class="tab-content">
    <div
      class="tab-pane active"
      role="tabpanel"
      aria-labelledby="my-requests-tab"
      id="my-requests"
    >
      <p>Open Requests Here</p>
      <ul data-bind="foreach: Config.requestOrgStore">
        <li data-bind="text: ID"></li>
      </ul>
    </div>
    <div
      class="tab-pane"
      role="tabpanel"
      aria-labelledby="new-request"
      id="new-request"
    >
      <div
        data-bind="template: {name: 'tmpl-new-request-view', data: NewRequestView}"
      ></div>
    </div>
    <div
      id="request-detail"
      class="tab-pane"
      role="tabpanel"
      aria-labelledby="request-detail-tab"
    >
      <div
        data-bind="template: {name: 'tmpl-request-detail', data: RequestDetailView}"
      ></div>
    </div>
  </div>
</div>
<div id="service-type-templates"></div>

<div id="tmpl-views">
  <script type="text/html" id="tmpl-new-request-view">
    <h2>Select the type of work order you would like to open:</h2>
    <div class="container text-center">
      <div class="row row-cols-4" data-bind="foreach: ServiceTypeStore">
        <div class="col">
          <div class="card text-center" data-bind="click: $root.NewRequest">
            <div class="card-body">
              <i class="fa fa-5x" data-bind="class: Icon"></i>
            </div>
            <div class="card-body">
              <h5 class="card-title" data-bind="text: Title"></h5>
            </div>
          </div>
        </div>
      </div>
    </div>
  </script>

  <script type="text/html" id="tmpl-request-detail">
    <!-- Report.RequestDetailView -->
    <div class="container">
      <h2>Service Request Detail</h2>
      <!-- ko if: !$data -->
      <div>Nothing to see here</div>
      <!-- /ko -->
      <!-- ko if: $data -->
      <div>
        <div class="card mb-3 w-100">
          <div class="card-body">
            <h4 class="card-title">Pipeline</h4>
          </div>
        </div>
        <div data-bind="template: {name: 'tmpl-request-header'}"></div>
        <div class="card mb-3 w-100">
          <div class="card-body">
            <h3
              class="card-title"
              data-bind="text: Fields.ServiceType.obs()?.Title"
            ></h3>
            <!-- ko if: ServiceTypeTemplate -->
            <div data-bind="using: ServiceTypeTemplate">
              <!-- ko if: IsLoading() -->
              <div class="d-flex justify-content-center">
                <div class="spinner-border" role="status">
                  <span class="visually-hidden">Loading...</span>
                </div>
              </div>
              <!-- /ko -->
              <!-- ko if: !IsLoading() && TemplateViewModel()  -->
              <div
                data-bind="template: {name: TemplateElmId, data: TemplateViewModel}"
              ></div>
              <!-- /ko -->
            </div>
            <!-- /ko -->
            <div></div>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-4">
            <div class="card">
              <div class="card-body">
                <h3 class="card-title">Attachments</h3>
                <div class="d-flex justify-content-center">
                  <div class="spinner-border" role="status">
                    <span class="visually-hidden">Loading...</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-8">
            <div class="card">
              <div class="card-body">
                <h3 class="card-title">Approvals and Actions Log</h3>
                <div class="d-flex justify-content-center">
                  <div class="spinner-border" role="status">
                    <span class="visually-hidden">Loading...</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="card mb-3 w-100">
          <div class="card-body">
            <h3 class="card-title">Comments</h3>
            <div class="d-flex justify-content-center">
              <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>
          </div>
        </div>
        <div>
          <!-- ko if: DisplayMode() == DisplayModes.New -->
          <button type="button" data-bind="click: SubmitNewRequest">
            Submit
          </button>
          <!-- /ko -->
          <!-- ko if: DisplayMode() == DisplayModes.View -->
          <button type="button" data-bind="click: EditRequest">Edit</button>
          <!-- /ko -->
          <!-- ko if: DisplayMode() == DisplayModes.Edit -->
          <button type="button" data-bind="click: UpdateRequest">
            Save Changes
          </button>
          <button type="button" data-bind="click: CancelChanges">Cancel</button>
          <!-- /ko -->
        </div>
      </div>
      <!-- /ko -->
    </div>
  </script>

  <script type="text/html" id="tmpl-request-header">
    <!-- Report.RequestDetail.Fields -->
    <div class="card mb-3 w-100">
      <div class="card-body">
        <h3 class="card-title">Requestor Information</h3>
        <!-- ko if: DisplayMode() == DisplayModes.New -->
        <div class="container-fluid" data-bind="using: Fields">
          <div class="row">
            <div class="col-6 pb-2">
              <h6>Request Status:</h6>
              <p data-bind="text: RequestStatus.obs()"></p>
            </div>
          </div>
          <div class="row">
            <div class="col-6 pb-2">
              <label
                ><h6>Request ID:</h6>
                <p data-bind="text: Title.obs()"></p
              ></label>
            </div>
            <div class="col-6 pb-2">
              <div class="form-group">
                <label><h6>Requestor Office:</h6></label>
                <select
                  class="form-control"
                  data-bind="value: RequestorOffice.obs,
                options: $root.Config.requestOrgStore,
                optionsText: (ro) => ro.Title"
                ></select>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-6 pb-2">
              <h6>Requestor:</h6>
              <input class="form-control" data-bind="text: Requestor.obs()" />
            </div>
          </div>
          <div class="row">
            <div class="col-6 pb-2">
              <h6>Requestor Phone:</h6>
              <input
                type="tel"
                class="form-control"
                data-bind="text: RequestorPhone.obs()"
              />
            </div>
            <div class="col-6 pb-2">
              <h6>Requestor Email:</h6>
              <input
                type="email"
                class="form-control"
                class="fluid"
                data-bind="text: RequestorEmail.obs()"
              />
            </div>
            <div class="col-12 pb-2">
              <h6>Service Type:</h6>
              <select
                class="form-control"
                class="fluid"
                data-bind="value: ServiceType.obs,
              options: $root.Config.serviceTypeStore,
              optionsText: (st) => st.Title"
              ></select>
            </div>
          </div>
        </div>
        <!-- /ko -->
        <!-- ko if: DisplayMode() != DisplayModes.New -->
        <div class="container-fluid" data-bind="using: Fields">
          <div class="row">
            <div class="col-6">
              <h6>Request Status:</h6>
              <p data-bind="text: RequestStatus.obs()"></p>
            </div>
          </div>
          <div class="row">
            <div class="col-6">
              <h6>Request ID:</h6>
              <p data-bind="text: Title.obs()"></p>
            </div>
            <div class="col-6">
              <h6>Requestor Office:</h6>
              <p data-bind="text: RequestorOffice.obs()?.Title"></p>
            </div>
          </div>
          <div class="row">
            <div class="col-6">
              <h6>Requestor:</h6>
              <p data-bind="text: Requestor.obs()?.Title"></p>
            </div>
          </div>
          <div class="row">
            <div class="col-6">
              <h6>Requestor Phone:</h6>
              <p data-bind="text: RequestorPhone.obs()"></p>
            </div>
            <div class="col-6">
              <h6>Requestor Email:</h6>
              <p data-bind="text: RequestorEmail.obs()"></p>
            </div>
            <div class="col-6">
              <h6>Submitted Date:</h6>
              <p data-bind="text: RequestSubmitted.obs()?.toLocaleString()"></p>
            </div>
            <div class="col-6">
              <h6>Service Type:</h6>
              <p data-bind="text: ServiceType.obs()?.Title"></p>
            </div>
          </div>
        </div>
        <!-- /ko -->
      </div>
    </div>
  </script>
</div>
<script
  type="text/javascript"
  src="../Apps/_layouts/15/clienttemplates.js"
></script>
<script
  type="text/javascript"
  src="../Apps/_layouts/15/clientforms.js"
></script>
<script
  type="text/javascript"
  src="../Apps/_layouts/15/clientpeoplepicker.js"
></script>
<script type="text/javascript" src="../Apps/_layouts/15/autofill.js"></script>

<script src="../SiteAssets/workorder/vendor/knockout/knockout-3.5.0.js"></script>
<script src="../SiteAssets/wo/common/KnockoutExtensions.js"></script>

<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
  crossorigin="anonymous"
></script>

<script defer type="module" src="../SiteAssets/wo/page_wo_db.js"></script>
