<link
  rel="stylesheet"
  href="../SiteAssets/workorder/vendor/jquery/jquery-ui-1.12.1.full/jquery-ui.css"
/>
<link
  rel="stylesheet"
  href="../SiteAssets/workorder/vendor/jquery/jquery-ui-1.12.1.full/jquery-ui.theme.css"
/>

<link
  rel="stylesheet"
  href="../SiteAssets/workorder/vendor/DataTables/DataTables-1.10.20/css/jquery.dataTables.min.css"
/>
<link
  rel="stylesheet"
  href="../SiteAssets/workorder/vendor/DataTables/datatables.min.css"
/>

<link
  rel="stylesheet"
  href="../SiteAssets/workorder/vendor/fontawesome-5.9.0/css/all.min.css"
/>
<!--<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">-->
<link rel="stylesheet" href="../SiteAssets/workorder/vendor/trix/trix.css" />
<link
  rel="stylesheet"
  href="../SiteAssets/workorder/vendor/Semantic-UI-CSS-master/semantic.min.css"
/>

<link rel="stylesheet" href="../SiteAssets/workorder/wo/workorder.css" />
<!-- common/RDT/app"  -->

<!-- <SharePoint:ScriptLink ID="ScriptLink1" name="SP.js" runat="server"
    ondemand="false" localizable="false" loadafterui="true" />
<SharePoint:ScriptLink ID="ScriptLink2" name="SP.UserProfiles.js" runat="server"
    ondemand="false" localizable="false" loadafterui="true" /> -->

<!-- <script type="text/javascript" src="/_layouts/15/SP.UserProfiles.js"></script> -->

<h1>WorkOrder System</h1>
<div id="tabs" style="display: none">
  <div class="ui top attached tabular menu">
    <a class="item" data-tab="my-orders">My Orders</a>
    <a class="item" data-tab="order-new">New Order</a>
    <!-- ko if: selectedServiceType -->
    <a class="item" data-tab="order-detail">Detail View</a>
    <!-- /ko -->
  </div>
  <div
    id="my-orders"
    data-tab="my-orders"
    class="ui bottom attached tab segment"
  >
    <div
      class="ui primary button segment"
      data-bind="visible: page() == 'app.aspx'"
      onclick="navSelectWorkOrder()"
    >
      New Order
    </div>

    <div class="ui grid">
      <div class="two wide column">
        <div class="ui secondary fluid vertical pointing menu">
          <a class="item active" data-tab="my-open-orders"> Open </a>
          <a class="item" data-tab="my-closed-orders"> Closed </a>
          <a class="item" data-tab="my-cancelled-orders"> Cancelled </a>
          <a class="item" data-tab="my-stype-orders"> By Service Type </a>
        </div>
      </div>
      <div class="fourteen wide column">
        <div
          id="my-open-orders"
          data-tab="my-open-orders"
          class="ui right attached tab fluid"
        >
          <div data-bind="visible: allOpenOrders().length == 0">
            <h2>
              You currently have no open orders<span
                data-bind="visible: page() == 'app'"
              >
                ,
                <a href="javascript:void(0)" onclick="navSelectWorkOrder()">
                  create
                </a>
                a new one </span
              >.
            </h2>
          </div>
          <div data-bind="visible: allOpenOrders().length > 0">
            <h2>Open Orders</h2>
            <table id="wo-open-orders" class="display data-table">
              <thead>
                <tr>
                  <th>Order ID</th>
                  <th>Service Type</th>
                  <th>Requesting Office</th>
                  <th>Requestor</th>
                  <th>Submitted Date</th>
                  <th>Est. Completion Date<span class="ui blue">*</span></th>
                </tr>
              </thead>
              <tbody data-bind="foreach: allOpenOrders">
                <tr>
                  <td
                    class="wo-id"
                    data-bind="click: $root.showWorkOrder, text: Title"
                  ></td>
                  <td data-bind="text: ServiceType.get_lookupValue()"></td>
                  <td data-bind="text: RequestorOffice.get_lookupValue()"></td>
                  <td data-bind="text: RequestorName"></td>
                  <td data-bind="text: Created.format('yyyy-MM-dd')"></td>
                  <td data-bind="text: $root.estimateClosingDate($data)"></td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <td>Order ID</td>
                  <td>Service Type</td>
                  <td>Requesting Office</td>
                  <td>Requestor</td>
                  <td>Submitted Date</td>
                  <td>Est. Completion Date<span class="ui blue">*</span></td>
                </tr>
              </tfoot>
            </table>
            <div class="ui info message">
              <div class="header">* Estimated Completion Date</div>
              <p>
                The estimated completion date is based on the average number of
                business days this service type is usually closed in and is not
                a guarantee of completion.
              </p>
            </div>
            <div
              id="wo-est-completion-modal"
              class="ui modal"
              style="display: none"
            >
              <div class="content">
                <h2 class="ui header">Esimated Completion Date</h2>
              </div>
              <div class="content">
                <p>How is</p>
              </div>
            </div>
          </div>
        </div>
        <div
          id="my-closed-orders"
          data-tab="my-closed-orders"
          class="ui right attached tab fluid"
        >
          <div data-bind="visible: allClosedOrders().length == 0">
            <h2>
              You currently have no Closed orders<span
                data-bind="visible: page() == 'app'"
              >
                ,
                <a href="javascript:void(0)" onclick="navSelectWorkOrder()">
                  create
                </a>
                a new one </span
              >.
            </h2>
          </div>
          <div data-bind="visible: allClosedOrders().length > 0">
            <h2>Closed Orders</h2>
            <table id="wo-closed-orders" class="display data-table">
              <thead>
                <tr>
                  <th>Order ID</th>
                  <th>Service Type</th>
                  <th>Requesting Office</th>
                  <th>Requestor</th>
                  <th>Submitted Date</th>
                  <th>Closed Date</th>
                </tr>
              </thead>
              <tbody data-bind="foreach: allClosedOrders">
                <tr>
                  <td
                    class="wo-id"
                    data-bind="click: $root.showWorkOrder, text: Title"
                  ></td>
                  <td data-bind="text: ServiceType.get_lookupValue()"></td>
                  <td data-bind="text: RequestorOffice.get_lookupValue()"></td>
                  <td data-bind="text: RequestorName"></td>
                  <td data-bind="text: Created.format('yyyy-MM-dd')"></td>
                  <td
                    data-bind="text: ClosedDate ? ClosedDate.format('yyyy-MM-dd') : 'error'"
                  ></td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <td>Order ID</td>
                  <td>Service Type</td>
                  <td>Requesting Office</td>
                  <td>Requestor</td>
                  <td>Submitted Date</td>
                  <td>Closed Date</td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
        <div
          id="my-cancelled-orders"
          data-tab="my-cancelled-orders"
          class="ui right attached tab fluid"
        >
          <div data-bind="visible: allCancelledOrders().length == 0">
            <h2>
              You currently have no Cancelled orders<span
                data-bind="visible: page() == 'app'"
              >
                ,
                <a href="javascript:void(0)" onclick="navSelectWorkOrder()">
                  create
                </a>
                a new one </span
              >.
            </h2>
          </div>
          <div data-bind="visible: allCancelledOrders().length > 0">
            <h2>Cancelled Orders</h2>
            <table id="wo-cancelled-orders" class="display data-table">
              <thead>
                <tr>
                  <th>Order ID</th>
                  <th>Service Type</th>
                  <th>Requesting Office</th>
                  <th>Requestor</th>
                  <th>Submitted Date</th>
                  <th>Closed Date</th>
                </tr>
              </thead>
              <tbody data-bind="foreach: allCancelledOrders">
                <tr>
                  <td
                    class="wo-id"
                    data-bind="click: $root.showWorkOrder, text: Title"
                  ></td>
                  <td data-bind="text: ServiceType.get_lookupValue()"></td>
                  <td data-bind="text: RequestorOffice.get_lookupValue()"></td>
                  <td data-bind="text: RequestorName"></td>
                  <td data-bind="text: Created.format('yyyy-MM-dd')"></td>
                  <td data-bind="text: ClosedDate.format('yyyy-MM-dd')"></td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <td>Order ID</td>
                  <td>Service Type</td>
                  <td>Requesting Office</td>
                  <td>Requestor</td>
                  <td>Submitted Date</td>
                  <td>Closed Date</td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
        <div
          id="my-stype-orders"
          data-tab="my-stype-orders"
          class="ui right attached tab fluid"
        >
          <!-- ko if: configServiceTypes -->
          <h2>Lookup orders by service type:</h2>
          <div class="ui form">
            <div class="">
              <div class="field">
                <label>Service Type:</label>
                <select
                  class="ui select"
                  type="select"
                  data-bind="value: lookupServiceType,
                                             options: lookupServiceTypeOptions(),
                                             optionsText: function(stype) {return stype.Title ? stype.Title : 'unknown'},
                                             optionsCaption: 'Select...'"
                ></select>
              </div>
            </div>
          </div>
          <div
            id="lookup-tables-container"
            data-bind="foreach: {data: lookupTables, as:'stypeTable'}"
          >
            <div
              class="ui fluid container"
              data-bind="visible: stypeTable.stype.UID == $root.lookupServiceType().UID"
            >
              <h3 data-bind="text: stypeTable.stype.Title"></h3>
              <table
                class="display data-table"
                data-bind="attr: {id: stypeTable.id}"
              >
                <thead>
                  <tr>
                    <td>Order ID</td>
                    <td>Requesting Office</td>
                    <td>Requestor</td>
                    <td>Request Status</td>
                    <td>Description</td>
                    <!-- ko foreach: stypeTable.cols -->
                    <td
                      class="disposable"
                      data-bind="text: stypeTable.viewFields[$data].displayName ? stypeTable.viewFields[$data].displayName : $data"
                    ></td>
                    <!-- /ko -->
                  </tr>
                </thead>
                <tbody
                  data-bind="foreach: {data: stypeTable.requests, as: 'order'}"
                >
                  <tr>
                    <td
                      data-bind="click: $root.showWorkOrder, text: Title"
                    ></td>
                    <td
                      data-bind="text: order.RequestorOffice.get_lookupValue()"
                    ></td>
                    <td data-bind="text: order.RequestorName"></td>
                    <td data-bind="text: order.RequestStatus"></td>
                    <td data-bind="text: $(RequestDescription).text()"></td>
                    <!-- ko if: stypeTable.cols.length -->
                    <!-- ko foreach: { data: stypeTable.cols, as: 'col' } -->
                    <td
                      class="disposable"
                      data-bind="text: $root.lookupParseText(col, stypeTable.viewFields, order.ServiceItem[col])"
                    ></td>
                    <!-- /ko -->
                    <!-- /ko -->
                  </tr>
                </tbody>
                <tfoot>
                  <tr>
                    <td>Order ID</td>
                    <td>Requesting Office</td>
                    <td>Requestor</td>
                    <td>Request Status</td>
                    <td></td>
                    <!-- ko foreach: stypeTable.cols -->
                    <td
                      class="disposable"
                      data-bind="text: stypeTable.viewFields[$data].displayName"
                    ></td>
                    <!-- /ko -->
                  </tr>
                </tfoot>
              </table>
            </div>
          </div>
          <!-- /ko -->
        </div>
      </div>
    </div>
  </div>

  <div
    id="order-new"
    data-tab="order-new"
    class="ui bottom attached tab segment"
  >
    <p>Select the type of work order you would like to open:</p>
    <!-- ko if: configServiceTypes -->
    <div
      class="ui four stackable cards"
      data-bind="foreach: configServiceTypes().sort(sortByTitle)"
    >
      <!-- ko if: Active -->
      <div class="card pointer" data-bind="click: showDescription.bind($data)">
        <!--<div class="center aligned content">
                    <div class="header" data-bind="text: vm.serviceTypeViews()[$data].name"></div>
                </div>-->
        <div class="center aligned content">
          <i
            class="fa fa-5x"
            aria-hidden="true"
            data-bind="class: $data.Icon"
          ></i>
          <!-- <div data-bind="html: vm.serviceTypeViews()[$data].icon"></div> -->
        </div>
        <div
          class="ui bottom attached primary button"
          data-bind="text: $data.Title"
        >
          Create
        </div>

        <!--<a data-bind="click: showDescription($data), title: vm.serviceTypeViews()[$data].name">
                    <div data-bind="html: vm.serviceTypeViews()[$data].icon"></div>
                    <p data-bind="text: vm.serviceTypeViews()[$data].name"></p>
                </a>-->
      </div>
      <!-- /ko -->
    </div>
    <!-- /ko -->
    <div id="wo-description-modal" class="ui modal" style="display: none">
      <div
        class="header"
        data-bind="text: selectedServiceType() ? selectedServiceType().Title : 'Oops, something went wrong'"
      ></div>
      <div class="content">
        <div
          data-bind="html: selectedServiceType() ? selectedServiceType().Description : ''"
        ></div>
      </div>
      <div class="actions">
        <div class="actions">
          <div class="ui black deny button" onclick="dismissDescription()">
            Close
          </div>
          <div
            class="ui positive right labeled icon button"
            onclick="newWorkOrder()"
          >
            Create New
            <i class="checkmark icon"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div
    id="order-detail"
    data-tab="order-detail"
    class="ui bottom attached tab segment"
  >
    <!-- ko ifnot: selectedServiceType -->
    <div class="ui fluid card">
      <div class="content">
        <h3>
          Please select an open request from the
          <a href="./app.aspx?tab=my-orders">Open Orders</a> Tab or
          <a href="./app.aspx?tab=order-new"> Create a New Order</a>
        </h3>
      </div>
    </div>
    <!-- /ko -->
    <!-- ko if: selectedServiceType -->
    <div class="sticky">
      <div class="ui fluid card">
        <div class="content">
          <div class="ui left middle aligned grid">
            <div class="row">
              <div class="sixteen wide column">
                <div id="wo-progress-pipeline"></div>
                <p>
                  <span>
                    <a
                      title="View this link on the admin dash"
                      target="blank"
                      class="fas fa-user-shield"
                      data-bind="attr: { href: requestLinkAdmin }, "
                    >
                    </a>
                  </span>
                  <span
                    title="Refresh this request"
                    class="fas fa-sync pointer"
                    onclick="refreshWorkOrderItem(vm.requestID())"
                  ></span>
                  Loaded:
                  <span
                    data-bind="text: requestLoaded().toLocaleString()"
                  ></span>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="ui hidden divider"></div>
    <div class="ui left middle aligned grid">
      <div class="row">
        <div class="six wide column">
          <h1 data-bind="text: selectedServiceType().Title"></h1>
        </div>
      </div>
    </div>
    <div class="ui hidden divider"></div>
    <div id="wo-form">
      <div class="ui grid">
        <div class="sixteen wide column">
          <div id="wo-requestor-info" class="ui fluid card">
            <div class="content">
              <h2 class="ui header">Requestor Information</h2>
            </div>
            <div class="content">
              <div class="ui form" id="table-wo-request-info">
                <div class="two fields">
                  <div class="field">
                    <label> Request Status: </label>
                    <input
                      class="non-editable-field"
                      type="text"
                      data-bind="value: requestStatus"
                    />
                  </div>
                  <div class="field" data-bind="visible: requestClosedDate">
                    <label> Closed Date Date: </label>
                    <input
                      class="non-editable-field"
                      type="text"
                      data-bind="value: requestClosedDate() ? requestClosedDate().toLocaleString() : ''"
                    />
                  </div>
                </div>
                <div class="two fields">
                  <div class="field">
                    <label> Request ID: </label>
                    <input
                      class="non-editable-field"
                      type="text"
                      data-bind="value: requestID"
                    />
                  </div>
                  <div class="field">
                    <label data-bind="if: configRequestingOffices()">
                      Requestor Office<span class="required">*</span>:
                    </label>
                    <select
                      class="editable-field new"
                      type="text"
                      data-bind="value: requestorOffice, 
                            options: requestorOfficeUserOpt, 
                            optionsText: function(ro) {return ro.Title},
                            disable: currentView() == 'view'"
                    ></select>
                  </div>
                </div>
                <div class="two fields">
                  <div class="field">
                    <label>Requestor Name: </label>
                    <input
                      class="non-editable-field"
                      type="text"
                      data-bind="value: requestorName"
                    />
                  </div>

                  <!-- <div class="field">
                    <label>Request Manager: </label>
                    <input
                      class="editable-field"
                      type="text"
                      disabled="true"
                      data-bind="value: requestorManager.userName, visible: currentView() == 'view'"
                    />
                    <div
                      id="peopleRequestorManager"
                      class="editable-field"
                      data-bind="people: requestorManager.user, 
                        visible: currentView() != 'view'"
                    ></div>
                  </div> -->
                </div>
                <div class="two fields">
                  <div class="field">
                    <label>Requestor Phone: </label>
                    <input
                      class="editable-field"
                      type="text"
                      data-bind="value: requestorTelephone, disable: currentView() == 'view'"
                    />
                  </div>
                  <div class="field">
                    <label> Requestor Email: </label>
                    <input
                      class="non-editable-field"
                      type="text"
                      data-bind="value: requestorEmail"
                    />
                  </div>
                </div>
                <div class="two fields">
                  <div class="field">
                    <label> Submitted Date: </label>
                    <input
                      class="non-editable-field"
                      type="text"
                      data-bind="value: requestSubmittedDate() ? requestSubmittedDate().toLocaleString() : ''"
                    />
                  </div>
                  <div class="field">
                    <label>
                      Service Type<span class="required">*</span>:
                    </label>
                    <select
                      class="editable-field new"
                      type="select"
                      data-bind="value: selectedServiceType,
                                                           options: configServiceTypes() ? configServiceTypes().filter((stype) => stype.Active) : [{}, {}],
                                                           optionsText: function(stype) {return stype.Title ? stype.Title : 'unknown'},
                                                           optionsCaption: 'Select...',
                                                           enable: currentView() == 'new'"
                    ></select>
                  </div>
                </div>
                <!-- <div class="field">
                  <label>
                    Request Subject <span class="optional">(Optional)</span>:
                  </label>
                  <input
                    class="editable-field"
                    data-bind="value: requestSubject"
                    placeholder="Enter a short description..."
                  />
                </div> -->
              </div>
            </div>
          </div>
        </div>
        <!-- Experimental subscriber feature, we don't have time to worry about this yet -->
        <!-- <div class="four wide column" style="display: none">
          <div id="wo-requestor-info" class="ui fluid card">
            <div class="content">
              <h2 class="ui header">Request Subscribers</h2>
            </div>
            <div class="content">
              <div data-bind="">
                <p>
                  Are you opening this work order on somebody elses behalf, or
                  would you like to subscribe someone to receive updates?
                </p>
              </div>
              <ul
                data-bind="foreach: requestAssignments().filter(function (assignee) {return assignee.Role == 'Subscriber'})"
              >
                <li data-bind="text: Assignee.get_lookupValue()"></li>
              </ul>
            </div>
            <div class="content">
              <button
                type="button"
                class="ui positive button editable-field"
                onclick="newAssignment('Subscriber')"
              >
                <i class="user plus icon"></i>Add
              </button>
            </div>
          </div>
        </div> -->
      </div>
      <div id="service-types" class="ui grid" data-bind="">
        <!-- Everything but the input form should be standardized. -->
        <!-- Capture the specific info for each service type below. -->
        <div class="sixteen wide column">
          <div class="ui fluid card service-type-detail content">
            <div class="content">
              <!-- ko if: selectedServiceType -->
              <h2
                class="ui header"
                data-bind="text: selectedServiceType().Title"
              ></h2>
              <!-- /ko -->
            </div>
            <div class="content">
              <!-- Specific request type forms inserted here -->
              <!-- ko if: selectedServiceType().TemplateName -->
              <div
                id="service-type-form"
                data-bind="template: { name: selectedServiceTypeTemplate }"
              ></div>
              <!-- /ko -->
              <!-- Generic description field goes here -->
              <!-- ko if: selectedServiceType -->
              <div
                data-bind="visible: selectedServiceType().DescriptionRequired || requestShowDescription"
              >
                <div class="ui form">
                  <div class="field">
                    <label
                      data-bind="text: selectedServiceType().DescriptionTitle"
                      ><span
                        class="required"
                        data-bind="visible: selectedServiceType().DescriptionRequired"
                        >*</span
                      ></label
                    >
                    <!-- <textarea
                    id="workorder-description"
                    class="editable-field"
                    data-bind="textInput: requestDescription, disable: currentView()=='view'"
                  ></textarea> -->
                    <textarea
                      id="request-description"
                      data-bind="value: requestDescriptionHTML, visible: false"
                    ></textarea>
                    <div data-bind="visible: currentView() != 'view'">
                      <trix-editor
                        id="trix-request-description"
                        input="request-description"
                        class="editable-field"
                        data-bind="html: requestDescriptionHTML"
                      >
                      </trix-editor>
                    </div>
                    <div
                      data-bind="html: requestDescriptionHTML, visible: currentView() == 'view'"
                    ></div>
                  </div>
                </div>
              </div>
              <!-- /ko -->
            </div>
          </div>
        </div>
      </div>
      <!--Attachments and actions/approvals workflow-->
      <div class="ui grid">
        <div class="six wide column" data-bind="if: selectedServiceType">
          <!-- Capture any attachments below -->
          <div id="wo-attachments" class="ui fluid card" data-bind="">
            <div class="content">
              <h2 class="ui header">Attachments</h2>
            </div>
            <div class="content">
              <div
                data-bind="visible: selectedServiceType().AttachmentRequired"
              >
                <h3>
                  This service type has required attachments:<span
                    class="required"
                    >*</span
                  >
                </h3>
              </div>
              <div
                id="instr-attachments"
                data-bind="html: selectedServiceType().AttachmentDescription"
              >
                Instructions for uploading attachments.
              </div>
              <table
                id="table-attachments"
                class="ui very basic celled table"
                data-bind="visible: requestAttachments().length > 0"
              >
                <thead>
                  <tr>
                    <th>Title</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody
                  data-bind="foreach: requestAttachments().filter((att) => att.IsActive)"
                >
                  <tr>
                    <td>
                      <a
                        target="_blank"
                        data-bind="attr: { href: FileRef }, text: Title"
                      ></a>
                    </td>
                    <td>
                      <i
                        class="fas fa-search pointer"
                        data-bind="click: $root.attachmentView"
                      ></i>
                      <i
                        class="fas fa-trash pointer"
                        data-bind="click: $root.attachmentRemove"
                      ></i>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="content aligned right">
              <button
                type="button"
                class="ui primary button"
                onclick="newAttachment()"
                data-bind="enable: requestIsActive"
              >
                New Attachment
              </button>
            </div>
          </div>
        </div>
        <div class="ten wide column" data-bind="visible: showActionsTable">
          <!-- Approvals here -->
          <div id="wo-approvals" class="ui styled fluid accordion">
            <div class="title">
              <h2 class="ui header">
                <i class="dropdown icon"></i>
                Approvals and Actions Log
              </h2>
            </div>
            <div class="content">
              <!--<div class="admin-action-zone" data-bind="visible: pu10kShowAdmin">
                                <h3>Administrative Action Zone</h3>
                                <p>This purchase request requires your approval:</p>
                                <button type="button" href="javascript:void(0)" onclick="newApproval()">Approve/Reject</button>
                            </div>
                            <div data-bind="visible: requestApprovals().length == 0">
                                <p>This request has not been approved yet, check back later.</p>
                            </div>-->
              <table
                id="table-actions"
                class="ui celled very basic table"
                data-bind="visible: requestActions().length > 0"
              >
                <thead>
                  <tr>
                    <th>Action Taker</th>
                    <th>Action Type</th>
                    <th>Description</th>
                    <th>Date</th>
                  </tr>
                </thead>
                <tbody data-bind="foreach: requestActions">
                  <tr>
                    <td class="collapsing">
                      <p data-bind="text: Author.get_lookupValue()"></p>
                    </td>
                    <td class="collapsing">
                      <p data-bind="text: ActionType"></p>
                    </td>
                    <td>
                      <p data-bind="text: Description"></p>
                    </td>
                    <td class="right aligned collapsing">
                      <p data-bind="text: Created.toLocaleString()"></p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div id="wo-comments" class="ui fluid card service-type-detail">
        <div class="content">
          <h2 class="ui header">Comments</h2>
        </div>
        <div class="content">
          <p>
            Leave additional comments/instructions here. Note: Anyone with
            access to this record will be able to view them.
          </p>
          <table
            id="table-comments"
            class="ui celled very basic table"
            data-bind="visible: requestComments().length > 0"
          >
            <thead>
              <tr>
                <th>Author</th>
                <th>Comment</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody data-bind="foreach: requestComments">
              <tr>
                <td class="collapsing">
                  <p data-bind="text: Author.get_lookupValue()"></p>
                </td>
                <td>
                  <p data-bind="text: Comment"></p>
                </td>
                <td class="right aligned collapsing">
                  <p data-bind="text: Created.toLocaleString()"></p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="content">
          <div class="ui form">
            <div class="field">
              <textarea
                placeholder="Enter a new comment..."
                data-bind="value: commentNew"
              ></textarea>
            </div>
            <button
              type="button"
              class="ui primary button"
              onclick="submitComment()"
            >
              Submit Comment
            </button>
          </div>
        </div>
      </div>
    </div>
    <br />
    <div data-bind="visible: requestIsActive()">
      <button
        type="button"
        class="editable-field ui primary button"
        onclick="saveWorkOrder()"
        data-bind="enable: canSaveForm, visible: canSaveForm"
      >
        Save
      </button>
      <!-- <button
        id="edit-form"
        type="button"
        class="ui basic blue button"
        onclick="editWorkOrder()"
        data-bind="enable: canEditForm, visible: canEditForm"
      >
        Edit
      </button> -->
      <!-- <button
        id="close-form"
        type="button"
        class="ui basic red button"
        onclick="closeWorkOrder()"
        data-bind="enable: canEditForm"
      >
        Cancel
      </button> -->
    </div>
    <!-- /ko -->
  </div>
</div>
<div id="service-type-templates"></div>

<!--<script src="/_layouts/15/SP.Runtime.js"></script>
<script src="/_layouts/15/SP.js"></script>
<script src="/_layouts/15/SP.UserProfiles.js"></script>-->
<script
  type="text/javascript"
  src="../Apps/_layouts/15/clienttemplates.js"
></script>
<script
  type="text/javascript"
  src="../Apps/_layouts/15/clientforms.js"
></script>
<script
  type="text/javascript"
  src="../Apps/_layouts/15/clientpeoplepicker.js"
></script>

<script type="text/javascript" src="../Apps/_layouts/15/autofill.js"></script>
<script src="../SiteAssets/workorder/vendor/jquery/jquery-3.3.1.min.js"></script>
<script src="../SiteAssets/workorder/vendor/jquery/jquery.SPServices.min.js"></script>
<script src="../SiteAssets/workorder/vendor/jquery/jquery-ui-1.12.1.full/external/jquery/jquery.js"></script>
<script src="../SiteAssets/workorder/vendor/jquery/jquery-ui-1.12.1.full/jquery-ui.js"></script>
<script
  src="../SiteAssets/workorder/vendor/DataTables/DataTables-1.10.20/js/jquery.dataTables.min.js"
  type="text/javascript"
></script>
<script src="../SiteAssets/workorder/vendor/DataTables/datatables.min.js"></script>
<script src="../SiteAssets/workorder/vendor/knockout/knockout-3.5.0.js"></script>
<script src="../SiteAssets/workorder/vendor/trix/trix.js"></script>
<script src="../SiteAssets/workorder/vendor/Semantic-UI-CSS-master/semantic.min.js"></script>
<!-- <script src="../SiteAssets/workorder/vendor/nicEdit/nicEdit.js"></script> -->

<script
  type="text/javascript"
  src="http://js.nicedit.com/nicEdit-latest.js"
></script>

<script src="../SiteAssets/workorder/common/sal.js"></script>
<script src="../SiteAssets/workorder/common/common.js"></script>
<script src="../SiteAssets/workorder/common/notifications.js"></script>
<script src="../SiteAssets/workorder/common/deployment.js"></script>

<script src="../SiteAssets/workorder/wo/viewmodels.js"></script>
<script src="../SiteAssets/workorder/wo/workorder.js"></script>
